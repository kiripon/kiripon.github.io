<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>自由研究帳 - Type-Families</title>
        <link rel="stylesheet" type="text/css" href="/css/default.css" />
	<script type="text/javascript" src="//typesquare.com/accessor/script/typesquare.js?3gh7POzSj-0%3D" charset="utf-8"></script>
	
    </head>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-56315243-1', 'auto');
      ga('send', 'pageview');
    </script>
    <body>
        <div id="header">
            <div id="logo">
                <a href="/">自由研究帳</a>
            </div>
            <div id="navigation">
                <a href="/">HOME</a>
                <a href="/about.html">ABOUT</a>
                <a href="/contact.html">CONTACT</a>
                <a href="/archive.html">ARHCIVE</a>
            </div>
        </div>
        <div id="content">
            <h1>Type-Families</h1>

            <link rel="stylesheet" type="text/css" href="/css/syntax.css" />
<div class="info">
    Posted on none
    
</div>
<div class="info">
  
</div>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="fu">!--</span></code></pre>
<pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> <span class="ot">{-# LANGUAGE TypeFamilies #-}</span>
<span class="ot">&gt;</span> <span class="kw">module</span> <span class="dt">TypeFamilies</span> <span class="kw">where</span></code></pre>
<p>–&gt;</p>
<ul>
<li>foldに使いたいし使えるかもしれないからこれ読んだ。</li>
<li>http://www.haskell.org/haskellwiki/GHC/Type_families</li>
</ul>
<h2 id="type-familyとは">Type familyとは</h2>
<p>Type family は型理論からコンセプトを持ってきてる 型理論での indexed type family は型レベルの部分関数(partial function)になっている。 この関数に引数(type indicesとよばれる)を与えると、型ができる。 型族はプログラムになんのデータコンストラクタを扱っているかを計算させることができ、単純な型システムで型が固定されたり、parametrically polymorphic typeとは異なる。</p>
<p>Vanillaなpolymorphic data typeや関数は１つだけ定義を持ち、その型のすべてのインスタンスはその定義を用いる. Type classやtype camilyはそれとは対照的に、インターフェースの定義と任意の個数のインスタンス宣言を持つ。 Type familyのインターフェース定義はkindとarityを規定する。</p>
<h3 id="パラメータを持つデータ型都の違い">パラメータを持つデータ型都の違い</h3>
<p>まずCharのリストを実装してみる。</p>
<pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> <span class="kw">data</span> family <span class="dt">XList</span> a
<span class="ot">&gt;</span> <span class="kw">data</span> <span class="kw">instance</span> <span class="dt">XList</span> <span class="dt">Char</span> <span class="fu">=</span> <span class="dt">XCons</span> <span class="fu">!</span><span class="dt">Char</span> <span class="fu">!</span>(<span class="dt">XList</span> <span class="dt">Char</span>) <span class="fu">|</span> <span class="dt">XNil</span></code></pre>
<p>これは普通のCharのリストの宣言になる。 では、つぎに () のリストを考えてみる。ここで () はなんの情報も持たないので、()のリストは長さの情報だけ持っていればいいことになる。なので、()のリストの時には長さだけを覚える実装にしたい。 普通のデータ型ではこんなことはできないが、type familyのちからを持ってすれば可能になる。</p>
<pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> <span class="kw">data</span> <span class="kw">instance</span> <span class="dt">XList</span> () <span class="fu">=</span> <span class="dt">XListUnit</span> <span class="fu">!</span><span class="dt">Int</span></code></pre>
<p>ただし、右辺のコンストラクタは別の名前を持たなければならない。 <code>data instance</code>の右辺の宣言は普通のデータ定義と同じ文法だ。 実は、<code>data instance</code>という宣言は<code>data</code>宣言と以下で述べる<code>type instance</code>宣言を略記したものとおなじである。</p>
<p>GADTsはtype familyと次の意味で類似している,parametricな型のコストラクタが型変数に依存することを許しているのだ。 しかし、すべてのGADTコンストラクタは1つの場所でまとめて定義しなければならない。ところがtype familyは拡張することができる。 functional dependencies はtype familyと類似している,そしてfunctional dependenciesを使う多くのtype classは同じようにtype familyで記述できる。 functional dependencciesが関係を記述するのに対して、type familyはより関数的なスタイルで記述ができる。</p>
<h3 id="使い方">使い方</h3>
<p><code>{-# LANGUAGE TypeFamilies #-}</code>をつける</p>
<h2 id="associated-data-type-example">associated data type example</h2>
<h3 id="class-declaration">class declaration</h3>
<pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> <span class="kw">class</span> <span class="dt">GMapKey</span> k <span class="kw">where</span>
<span class="ot">&gt;</span>   <span class="kw">data</span> <span class="dt">GMap</span><span class="ot"> k ::</span> <span class="fu">*</span> <span class="ot">-&gt;</span> <span class="fu">*</span>
<span class="ot">&gt;   empty ::</span> <span class="dt">GMap</span> k v
<span class="ot">&gt;   lookup ::</span> k <span class="ot">-&gt;</span> <span class="dt">GMap</span> k v <span class="ot">-&gt;</span> <span class="dt">Maybe</span> v
<span class="ot">&gt;   insert ::</span> k <span class="ot">-&gt;</span> v <span class="ot">-&gt;</span> <span class="dt">GMap</span> k v <span class="ot">-&gt;</span> <span class="dt">GMap</span> k v</code></pre>
<p>クラスに対して_associated data family_の宣言をすることができる。 この宣言では_associated data_であるところの<code>GMap k</code>に_kind signature_を与えている。</p>

<br>

<div id="disqus_thread"><div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  // required: replace example with your forum shortname
  var disqus_shortname = 'kiripon';
  
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  // required: replace example with your forum shortname
  var disqus_shortname = 'kiripon';
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

        </div>
        <div id="footer">
	  <p>Copyright(C) 2013-2014, Kiripon</p>
	  <p>Source code font is <a href="https://github.com/i-tu/Hasklig">Hasklig</a>,distributed under <a href="/texts/LICENSE.txt">OFL</a>.</p>
	  <p>Site generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a></p>
        </div>
    </body>
</html>
